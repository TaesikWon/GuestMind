{% extends "base.html" %}
{% block title %}ê°ì • ë¶„ì„ - SoulStay{% endblock %}

{% block content %}
<div class="emotion-section">

  <h2 class="fw-bold mb-4 text-teal">Comment</h2>

  <!-- ê°ì • ë¶„ì„ í¼ -->
  <form id="emotionForm" method="post" action="/emotion/analyze" class="mb-4">
    <div class="mb-3">
      <textarea
        name="text"
        class="form-control"
        rows="4"
        placeholder="ê³ ê°ë‹˜ì˜ ì˜ê²¬ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."
        required>{{ text or '' }}</textarea>
    </div>

    <button id="analyzeBtn" type="submit" class="btn btn-primary px-4">
      Start
    </button>

    <!-- ğŸŒ€ ë¡œë”© ìŠ¤í”¼ë„ˆ -->
    <div id="loadingSpinner" class="mt-3" style="display: none;">
      <div class="spinner-border spinner-gold" role="status"></div>
      <p class="mt-2 mb-0 text-muted small">ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” â˜•</p>
    </div>
  </form>

  <!-- ê²°ê³¼ ì˜ì—­ -->
  {% if result %}
  <div class="card card-custom mt-4">
    <div class="card-body text-start">
      <h5 class="card-title fw-bold text-teal">ë¶„ì„ ê²°ê³¼</h5>

      <p class="mb-1">
        <strong>ê°ì •:</strong>
        <span class="
          {% if result.emotion == 'ê¸ì •' %}
            emotion-positive
          {% elif result.emotion == 'ë¶€ì •' %}
            emotion-negative
          {% else %}
            emotion-neutral
          {% endif %}
        ">
          {{ result.emotion }}
        </span>
      </p>

      {% if result.reason %}
      <p class="mb-0"><strong>ì´ìœ :</strong> {{ result.reason }}</p>
      {% endif %}
    </div>
  </div>

  {% else %}
  <div class="alert alert-light border mt-4 text-muted" role="alert">
    ì•„ì§ ë¶„ì„ëœ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.<br>
    ìœ„ ì…ë ¥ì°½ì— ì˜ê²¬ì„ ì…ë ¥í•˜ì‹œê³  <strong>â€œStartâ€</strong>ì„ ëˆŒëŸ¬ë³´ì„¸ìš” ğŸ˜Š
  </div>
  {% endif %}
</div>

<!-- ğŸ” JS ë¡œì§ -->
<script>
document.getElementById("emotionForm").addEventListener("submit", function() {
  document.getElementById("loadingSpinner").style.display = "block";
  document.getElementById("analyzeBtn").disabled = true;
});
</script>
{% endblock %}
